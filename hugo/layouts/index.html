{{ define "javascript" }}
<script>
  // Makes the header expand to the width of the (fluid) main container
  $(function () {
      var resize_navbar = function() {
          var width = 0;
          $('#main-container .col-12').each(function() {
              width += $(this).width();
          });
          $("#navbar-container").css("max-width", width);
      };
      $(window).resize(resize_navbar);
      resize_navbar();
  })
</script>
{{ end }}

{{ define "main" }}
<div class="row justify-content-center">
  {{ $.Scratch.Set "paper_count" 0 }}
  {{ range $.Site.Data.papers }}
    {{ $.Scratch.Add "paper_count" (len .) }}
  {{ end }}

  <div class="col-12 col-xl-2">
    <h2 class="pl-2 pb-2">Welcome to the ACL Anthology!</h2>

    <aside class="card acl-greeting font-weight-light mb-3">
      <div class="card-body">
        The ACL Anthology currently hosts {{ $.Scratch.Get "paper_count" }} papers on the study of computational linguistics and natural language processing.
      </div>
      <div class="card-body">
        <a href="http://groups.google.com/group/acl-anthology?hl=en">Subscribe to the mailing list</a> to receive announcements and updates to the Anthology.
      </div>
    </aside>

    <aside class="alert alert-info acl-news mb-3" role="alert">
      <!-- The news message pulls from content/_index.md -->
      {{ if (gt (time .PublishDate).Year 2018) }}
      <div class="acl-news-date">{{ .PublishDate.Format "January 2006" }}</div>
      {{ end }}
      {{ .Content }}
    </aside>

    <div class="row mb-3">
      {{ if (fileExists "/data-export/anthology.bib.gz") }}
      <div class="col-6 col-xl-12 mb-2">
        <a class="btn btn-block btn-info" href="{{ "/anthology.bib.gz" | relURL }}">Full Anthology as BibTeX ({{ printf "%.2f MB" (div (os.Stat "/data-export/anthology.bib.gz").Size 1000000.0) }})</a>
      </div>
      {{ end }}
      <div class="col-6 col-xl-12 mb-2">
        <a class="btn btn-block btn-warning" href="https://github.com/acl-org/acl-anthology/issues/170">Give feedback
        </a>
      </div>
    </div>
  </div><div class="col-12 col-xl-10 col-xl-width-auto">
    <main aria-role="main">
    <div>
    <h4>ACL Events</h4>
    {{/* ACL EVENTS */}}
    {{/* Hardcoded range of years because the table layout depends on it */}}
    {{ $all_years := seq 2019 -1 1970 }}
    {{/* Hardcoded range of decades because the table layout depends on it */}}
    {{ $all_decades := seq 201 -1 197 }}
    {{/* Years that should have a border on their left-hand side */}}
    {{ $border_years := slice "2019" "2009" "1999" "1989" }}

    <ul class="nav nav-tabs nav-tabs-xs mb-3" id="confs-tab" role="tablist">
      <!-- TODO: also add one for SIGs -->
      {{ range $venue := sort $.Site.Data.venues "slug" "asc" }}
        {{ if (and $venue.is_toplevel $venue.is_acl) }}
          {{ $venue_page := $.Site.GetPage (printf "/venues/%s.md" $venue.slug) }}
          {{ $acronym := index $venue_page.Params "venue" }}
          {{ $slug := $venue.slug }}
      <li class="nav-item">
        <a class="nav-link {{ cond (eq $slug "acl") "active" "" }}" id="tab-{{ $slug }}-tab" data-toggle="tab" href="#tabs-{{ $slug }}" role="tab" aria-controls="tabs-{{ $slug }}" aria-selected="{{ cond (eq $slug "acl") "true" "false" }}">{{ $acronym }}</a>
      </li>
        <!-- Just up from https://getbootstrap.com/docs/4.0/components/navs/#using-data-attributes -->
        {{ end }}
      {{ end }}
    </ul>
    </div>

    <div class="tab-content" id="tabs-tabContent">
      {{ range $venue := sort $.Site.Data.venues "slug" "asc" }}
        {{ if (and $venue.is_toplevel $venue.is_acl) }}
          {{ $venue_page := $.Site.GetPage (printf "/venues/%s.md" $venue.slug) }}
          {{ $acronym := index $venue_page.Params "venue" }}
          {{ $slug := $venue.slug }}
        <div class="tab-pane fade {{ cond (eq $slug "acl") "show active" ""}}" id="tabs-{{ $slug }}" role="tabpanel" aria-labelledby="tabs-{{ $slug }}-tab">

          <table class="table table-hover table-sm table-responsive small text-nowrap">
            <thead>
              <tr class="text-center border-left border-right">
                <th class="border-left border-right" scope="col" colspan="11">
                  {{ $venue.name }}
                </th>
              </tr>
            </thead>
            <tbody class="border-bottom">
              {{ range $decade := $all_decades }}
              {{ $decade := string $decade }}
              <tr class="border-left border-right">
                <th scope="row" class="text-center">
                  <a href="{{ $venue_page.RelPermalink }}">{{ slicestr $decade 0 2 }})</a>
                </th>
                {{ range $year := sort $all_years }}
                  {{ $year := string $year }}
                  {{ $year_decade := slicestr $year 0 3 }}
                  {{ if eq $year_decade $decade }}
                    {{ if in $venue.years $year }}
                <td>
                    <a href="{{ relref $ (printf "/events/%s-%s.md" $venue.slug $year) }}">{{ slicestr $year 2 4 }}</a>
                  </td>
                  {{ else }}
                  <td>&nbsp;&nbsp;</td>
                  {{ end }}
                {{ end }}
                {{ end }}
              </tr>
              {{ end }}
            </tbody>
          </table>
        </div>
        {{ end }}
      {{ end }}
    </div>

    <div> <!-- non-ACL events -->
      <h4>Non-ACL Events</h4>
      {{/* NON-ACL EVENTS */}}
      {{/* Hardcoded range of years because the table layout depends on it */}}
      {{ $all_years := seq 2019 -1 1986 | append (slice 1982 1980 1978 1975 1973 1969 1967 1965) }}
      {{/* Years that should have a border on their left-hand side */}}
      {{ $border_years := slice "2019" "2009" "1999" "1989" }}

      <ul class="nav nav-tabs mb-3" id="confs-tab" role="tablist">
      <!-- TODO: also add one for SIGs -->
      {{ range $venue := sort $.Site.Data.venues "slug" "asc" }}
        {{ if (and $venue.is_toplevel (not $venue.is_acl)) }}
          {{ $venue_page := $.Site.GetPage (printf "/venues/%s.md" $venue.slug) }}
          {{ $acronym := index $venue_page.Params "venue" }}
          {{ $slug := $venue.slug }}
      <li class="nav-item">
        <a class="nav-link {{ cond (eq $slug "alta") "active" "" }}" id="tab-{{ $slug }}-tab" data-toggle="tab" href="#tabs-{{ $slug }}" role="tab" aria-controls="tabs-{{ $slug }}" aria-selected="{{ cond (eq $acronym "alta") "true" "false" }}">{{ $acronym }}</a>
      </li>
        <!-- Just up from https://getbootstrap.com/docs/4.0/components/navs/#using-data-attributes -->
        {{ end }}
      {{ end }}
    </ul>
    </div>

    <div class="tab-content" id="tabs-tabContent">
      {{ range $venue := sort $.Site.Data.venues "slug" "asc" }}
        {{ if (and $venue.is_toplevel (not $venue.is_acl)) }}
          {{ $venue_page := $.Site.GetPage (printf "/venues/%s.md" $venue.slug) }}
          {{ $acronym := index $venue_page.Params "venue" }}
          {{ $slug := $venue.slug }}
        <div class="tab-pane fade {{ cond (eq $slug "alta") "show active" ""}}" id="tabs-{{ $slug }}" role="tabpanel" aria-labelledby="tabs-{{ $slug }}-tab">

          <table class="table table-hover table-sm table-responsive small text-nowrap">
            <thead>
              <tr class="text-center border-left border-right">
                <th class="border-left border-right" scope="col" colspan="11">
                  {{ $venue.name }}
                </th>
              </tr>
            </thead>
            <tbody class="border-bottom">
              {{ range $decade := $all_decades }}
              {{ $decade := string $decade }}
              <tr class="border-left border-right">
                <th scope="row" class="text-center">
                  <a href="{{ $venue_page.RelPermalink }}">{{ slicestr $decade 0 2 }})</a>
                </th>
                {{ range $year := sort $all_years }}
                  {{ $year := string $year }}
                  {{ $year_decade := slicestr $year 0 3 }}
                  {{ if eq $year_decade $decade }}
                    {{ if in $venue.years $year }}
                <td>
                    <a href="{{ relref $ (printf "/events/%s-%s.md" $venue.slug $year) }}">{{ slicestr $year 2 4 }}</a>
                  </td>
                  {{ else }}
                  <td>&nbsp;&nbsp;</td>
                  {{ end }}
                {{ end }}
                {{ end }}
              </tr>
              {{ end }}
            </tbody>
          </table>
        </div>
        {{ end }}
      {{ end }}
    </div>

    </div>
    </main>
  </div>
</div>
{{ end }}
